{% extends "base" %}

{% block "title" %}Tweets for {{tedium.username | escapexml}}{% endblock %}

{% block "content" %}
    <form id='status-form' method='post'>
      <label for='status'>Current status</label>:
      <input type='text' name='status' value='{{my_status | escape_apos }}' id='status' width='{{ tedium.username | max_tweet_length }}' size='{{ tedium.username | max_tweet_length }}' />
      <input type='submit' name='update-status' value='&gt;&gt; Update!' />
      <input type='hidden' name='last_viewed' value='{{ last_viewed }}' />
      <input type='hidden' name='last_digest' value='{{ last_digest }}' />
    </form>

    <ol>
{% for tweet in tweets %}
<li class='{% if tweet._is_new %}new {% endif %}{% if tweet._is_notindigest %}notindigest {% endif %}{% if tweet._is_protected%}protected {% endif %}{% if tweet._is_spam%}spam{% endif %}'><span
class='time'>{{ tweet.date }}</span><span
class='author'><a target='_new' class='author-name' title='{{ tweet.author.fn | safe_attribute }}' href='http://twitter.com/{{ tweet.author.nick | safe_attribute }}'>{{ tweet.author.nick | escapexml }}</a>{% if not tweet.author.is_me %}
<form method='post'>replies: <input type='hidden' name='author-{{ tweet.author.id }}' value='{% if tweet.author.include_replies_to equals 1 %}hide{% else %}show{% endif %}' /><input type='hidden' name='last_viewed' value='{{ last_viewed }}' /><input type='hidden' name='last_digest' value='{{ last_digest }}' /><input class='replies-option-{% if tweet.author.include_replies_to equals 1 %}enabled{% else %}disabled{% endif %}' type='submit' name='set-author-include-replies-to' value='to' /></form>
<form method='post'><input type='hidden' name='author-{{ tweet.author.id }}' value='{% if tweet.author.include_replies_from equals 1 %}hide{% else %}show{% endif %}' /><input type='hidden' name='last_viewed' value='{{ last_viewed }}' /><input type='hidden' name='last_digest' value='{{ last_digest }}' /><input class='replies-option-{% if tweet.author.include_replies_from equals 1 %}enabled{% else %}disabled{% endif %}' type='submit' name='set-author-include-replies-from' value='from' /></form>
{% endif %}</span><span
class='tweet-tools'><form method='post'><input type='hidden' name='tweet-{{ tweet.id }}' value='{% if tweet.classified_spamminess equals 2 %}0{% else %}2{% endif %}' /><input type='hidden' name='last_viewed' value='{{ last_viewed }}' /><input type='hidden' name='last_digest' value='{{ last_digest }}' /><input type='image' {% if tweet.classified_spamminess equals 2 %}class='spamminess-selected' title='Unmark as spam' {% else %}title='Mark as spam'{% endif %} src='icons/email_error.png' name='classify' value='Toggle spam' /></form><form method='post'><input type='hidden' name='tweet-{{ tweet.id }}' value='{% if tweet.classified_spamminess equals 1 %}0{% else %}1{% endif %}' /><input type='hidden' name='last_viewed' value='{{ last_viewed }}' /><input type='hidden' name='last_digest' value='{{ last_digest }}'<input {% if tweet.classified_spamminess equals 1 %}class='spamminess-selected' title='Unmark as ham' {% else %}title='Mark as ham'{% endif %} type='image' src='icons/email.png' name='classify' value='Toggle ham' /></form><span class='spam-score' title='{{ tweet._spam_score }}'>({{ tweet._spam_score | format '1.1f' }})</span></span><span
class='tweet'>{{ tweet.tweet | htmlify }}</span></li>
{% endfor %}
</ol>

<p id='key'>
Key: <span class='notindigest'>new since last digest</span>, <span class='new'>new since last view</span>, <span class='protected'>statuses protected for this user</span>, <span class='spam'>detected as spam</span>. <img width='16' height='16' alt='tick' src='icons/tick.png' /> and <img width='16' height='16' alt='cross' src='icons/cross.png' /> indicate the current states, ie whether replies to and from the author in question are currently being shown (click to toggle). <img width='16' height='16' alt='email warning' src='icons/email_error.png' /> and <img width='16' height='16' alt='email' src='icons/email.png' /> control whether a tweet is marked as spam/ham respectively (highlighted if already marked). The number in brackets is the calculated probability of spaminess.
</p>

<p><a target='_new' href='http://twitter.com/'>Twitter</a> interface for <a target='_new' href='http://twitter.com/{{ tedium.username | safe_attribute }}'>{{ tedium.username | escapexml }}</a>.
{% if replies equals 'digest' %}
Showing some replies. <a href='?replies=all&amp;last_viewed={{ last_viewed }}&amp;last_digest={{ last_digest }}&amp;last_sequence={{ last_sequence }}'>Show all replies</a>.
{% else %}
Showing all replies. <a href='?replies=digest&amp;last_viewed={{ last_viewed }}&amp;last_digest={{ last_digest }}&amp;last_sequence={{ last_sequence }}'>Show fewer replies</a>.
{% endif %}
{% if spam equals 'none' %}
Hiding spam. <a href='?spam=all&amp;last_viewed={{ last_viewed }}&amp;last_digest={{ last_digest }}&amp;last_sequence={{ last_sequence }}'>Show spam</a>.
{% else %}
Showing spam. <a href='?spam=none&amp;last_viewed={{ last_viewed }}&amp;last_digest={{ last_digest }}&amp;last_sequence={{ last_sequence }}'>Hide spam</a>.
{% endif %}
</p>

<form method='POST'>
<input type='hidden' name='last_viewed' value='{{ last_viewed }}' />
<input type='hidden' name='last_digest' value='{{ last_digest }}' />
<label for='fixed-filter'>Current filter (comma-separated)</label>:
<input type='text' id='fixed-filter' name='fixed-filter' value='{{ fixed_filter }}' width='40' size='40' />
<input type='submit' name='update-filter' value='Set' />
</form>

{% endblock %}

{% block "tail" %}
<script type='text/javascript' src='script.js' />
{% endblock %}
